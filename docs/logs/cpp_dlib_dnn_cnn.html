<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>cpp dlib dnn cnn</title>
<link rel="stylesheet" href="boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot">
<link rel="home" href="index.html" title="logs - Blogs or News">
<link rel="up" href="index.html" title="logs - Blogs or News">
<link rel="prev" href="index.html" title="logs - Blogs or News">
<link rel="next" href="cpp_boost_serialization.html" title="cpp: boost serialization">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="index.html"><img src="images/prev.png" alt="Prev"></a><a accesskey="u" href="index.html"><img src="images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a><a accesskey="n" href="cpp_boost_serialization.html"><img src="images/next.png" alt="Next"></a>
</div>
<div class="article">
<div class="titlepage">
<div><div><h1 class="title">
<a name="cpp_dlib_dnn_cnn"></a>cpp dlib dnn cnn</h1></div></div>
<hr>
</div>
<p>
      c++ dlib dnn cnn - Posted on Jun 8, 2024 - See <a href="http://dlib.net" target="_top">http://dlib.net</a>
      - <a href="https://cppfx.xyz/logs" target="_top">Logs Home</a> - d0020
    </p>
<h2>
<a name="cpp_dlib_dnn_cnn.h0"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.role_cyan_cpp_dlib_dnn_cnn"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.role_cyan_cpp_dlib_dnn_cnn"><span class="cyan">cpp dlib dnn cnn</span></a>
    </h2>
<p>
      CNN - The convolutional neural network of c++ dlib.
    </p>
<p>
      c++ dlib deep neural network, machine learning, convolutional neural network.
    </p>
<h2>
<a name="cpp_dlib_dnn_cnn.h1"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.role_cyan_neural_network_layers"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.role_cyan_neural_network_layers"><span class="cyan">Neural Network Layers</span></a>
    </h2>
<p>
      CNN Layers
    </p>
<p>
      c++ dlib layer is also called SUBNET, a subnet has its own subnet, and a subnet
      can be used as subnet of other subnet.
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h2"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.images_or_samples"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.images_or_samples">Images
      or samples</a>
    </h3>
<p>
      Images or samples are stored in dlib::matrx .
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">image_type</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">matrix</span><span class="special">&lt;</span><span class="identifier">dlib</span><span class="special">::</span><span class="identifier">rgb_pixel</span><span class="special">&gt;;</span>

<span class="keyword">using</span> <span class="identifier">sample_type</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">matrix</span><span class="special">&lt;</span><span class="identifier">unsignd</span> <span class="keyword">long</span><span class="special">&gt;;</span>
</pre>
<h3>
<a name="cpp_dlib_dnn_cnn.h3"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.input_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.input_layer">Input
      Layer</a>
    </h3>
<p>
      Input image data. Input layer is the first layer of dlib nn layers.
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">input_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">input</span><span class="special">&lt;</span><span class="identifier">image_type</span><span class="special">&gt;;</span>
</pre>
<h3>
<a name="cpp_dlib_dnn_cnn.h4"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.convolutional_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.convolutional_layer">Convolutional
      Layer</a>
    </h3>
<p>
      Algorithm: Sum [ f(x) g(a-x) ]
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">con_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">con</span><span class="special">&lt;</span>
	<span class="number">2</span><span class="special">,</span>	<span class="comment">// num_filters</span>
	<span class="number">4</span><span class="special">,</span>	<span class="comment">// nr</span>
	<span class="number">4</span><span class="special">,</span>	<span class="comment">// nc</span>
	<span class="number">4</span><span class="special">,</span>	<span class="comment">// stride_y</span>
	<span class="number">4</span><span class="special">,</span>	<span class="comment">// stride_x</span>
	<span class="identifier">input_layer</span>	<span class="comment">// subnet</span>
<span class="special">&gt;;</span>
</pre>
<p>
      In this example, input_layer is used as the subnet of con_layer.
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h5"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.relu_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.relu_layer">ReLU
      Layer</a>
    </h3>
<p>
      Algorithm: Max (0, x)
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">relu_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">relu</span><span class="special">&lt;</span><span class="identifier">con_layer</span><span class="special">&gt;;</span>
</pre>
<p>
      In this example, con_layer is used as the subnet of relu_layer.
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h6"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.pooling_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.pooling_layer">Pooling
      Layer</a>
    </h3>
<h4>
<a name="cpp_dlib_dnn_cnn.h7"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.max_pool"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.max_pool">Max
      Pool</a>
    </h4>
<p>
      Scan each area of an image and take every max value.
    </p>
<h4>
<a name="cpp_dlib_dnn_cnn.h8"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.avg_pool"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.avg_pool">AVG
      Pool</a>
    </h4>
<p>
      Scan each area of an image and take every average value.
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">max_pool_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">max_pool</span><span class="special">&lt;</span>
	<span class="number">3</span><span class="special">,</span>	<span class="comment">// nr</span>
	<span class="number">3</span><span class="special">,</span>	<span class="comment">// nc</span>
	<span class="number">3</span><span class="special">,</span>	<span class="comment">// stride_y</span>
	<span class="number">3</span><span class="special">,</span>	<span class="comment">// stride_x</span>
	<span class="identifier">relu_layer</span>	<span class="comment">// subnet</span>
<span class="special">&gt;;</span>
</pre>
<p>
      In this example, relu_layer is used as the subnet of max_pool_layer .
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h9"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.fully_connection_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.fully_connection_layer">Fully
      Connection Layer</a>
    </h3>
<p>
      For classification and regression of next layers
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">fc_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">fc</span><span class="special">&lt;</span>
	<span class="number">2</span><span class="special">,</span>	<span class="comment">// num_outputs</span>
	<span class="identifier">max_pool_layer</span>	<span class="comment">// subnet</span>
<span class="special">&gt;;</span>
</pre>
<p>
      In this example, max_pool_layer is used as the subnet of fc_layer .
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h10"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.loss_layer"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.loss_layer">Loss
      Layer</a>
    </h3>
<p>
      The error loss. Less layer is the last layer of dlib nn layers.
    </p>
<h4>
<a name="cpp_dlib_dnn_cnn.h11"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.dlib_loss_multiclass_log"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.dlib_loss_multiclass_log">dlib::loss_multiclass_log</a>
    </h4>
<p>
      dlib::loss_multiclass_log: multiclass logistic regression loss layer.
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">loss_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">loss_multiclass_log</span><span class="special">&lt;</span>
	<span class="identifier">fc_layer</span>	<span class="comment">// subnet</span>
<span class="special">&gt;;</span>
</pre>
<p>
      In this example, fc_layer is used as the subnet of loss_layer .
    </p>
<h4>
<a name="cpp_dlib_dnn_cnn.h12"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.dlib_loss_mmod"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.dlib_loss_mmod">dlib::loss_mmod</a>
    </h4>
<p>
      dlib::loss_mmod: Max Margin Object Object Detection Loss Layer .
    </p>
<pre class="programlisting"><span class="keyword">using</span> <span class="identifier">loss_layer</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">loss_mmod</span><span class="special">&lt;</span>
	<span class="identifier">con_layer</span>	<span class="comment">// subnet</span>
<span class="special">&gt;;</span>
</pre>
<p>
      In this example, con_layer is used as the subnet of loss_layer .
    </p>
<p>
      <span class="blue">FC-layer can be used as the subnet of layer dlib::loss_multiclass_log,
      but it can not be used as the subnet of layer dlib::loss_mmod.</span>
    </p>
<h2>
<a name="cpp_dlib_dnn_cnn.h13"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.role_cyan_cpp_example"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.role_cyan_cpp_example"><span class="cyan">cpp example</span></a>
    </h2>
<p>
      c++ dlib cnn example.
    </p>
<h3>
<a name="cpp_dlib_dnn_cnn.h14"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.cpp_code"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.cpp_code">cpp
      code</a>
    </h3>
<p>
      File: <span class="underline">dnn.cpp</span>
    </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">dlib</span><span class="special">/</span><span class="identifier">dnn</span><span class="special">.</span><span class="identifier">h</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">dlib</span><span class="special">/</span><span class="identifier">data_io</span><span class="special">.</span><span class="identifier">h</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">utxcpp</span><span class="special">/</span><span class="identifier">core</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">namespace</span> <span class="identifier">my_dnn</span>
<span class="special">{</span>

<span class="keyword">using</span> <span class="identifier">image_type</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">matrix</span><span class="special">&lt;</span><span class="identifier">dlib</span><span class="special">::</span><span class="identifier">rgb_pixel</span><span class="special">&gt;;</span>

<span class="keyword">using</span> <span class="identifier">crap_net_type</span> <span class="special">=</span> <span class="identifier">dlib</span><span class="special">::</span><span class="identifier">loss_mmod</span><span class="special">&lt;</span>
	<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">con</span><span class="special">&lt;</span>
		<span class="number">1</span><span class="special">,</span>
		<span class="number">1</span><span class="special">,</span><span class="number">1</span><span class="special">,</span><span class="number">1</span><span class="special">,</span><span class="number">1</span><span class="special">,</span>
		<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">max_pool</span><span class="special">&lt;</span>
			<span class="number">2</span><span class="special">,</span><span class="number">2</span><span class="special">,</span><span class="number">2</span><span class="special">,</span><span class="number">2</span><span class="special">,</span>
			<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">relu</span><span class="special">&lt;</span>
				<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">con</span><span class="special">&lt;</span>
					<span class="number">3</span><span class="special">,</span>
					<span class="number">4</span><span class="special">,</span><span class="number">2</span><span class="special">,</span><span class="number">4</span><span class="special">,</span><span class="number">2</span><span class="special">,</span>
					<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">input</span><span class="special">&lt;</span><span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">image_type</span><span class="special">&gt;</span>
				<span class="special">&gt;</span>
			<span class="special">&gt;</span>
		<span class="special">&gt;</span>
	<span class="special">&gt;</span>
<span class="special">&gt;;</span>

<span class="keyword">using</span> <span class="identifier">label_type</span> <span class="special">=</span> <span class="keyword">typename</span> <span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">crap_net_type</span><span class="special">::</span><span class="identifier">training_label_type</span><span class="special">;</span>

<span class="special">}</span>	<span class="comment">// namespace mydnn</span>

<span class="keyword">int</span> <span class="identifier">main</span><span class="special">()</span>
<span class="special">{</span>
	<span class="identifier">utx</span><span class="special">::</span><span class="identifier">same_assert</span><span class="special">&lt;</span><span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">label_type</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">dlib</span><span class="special">::</span><span class="identifier">mmod_rect</span><span class="special">&gt;&gt;();</span>

	<span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">image_type</span><span class="special">&gt;</span> <span class="identifier">images</span><span class="special">;</span>
	<span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">label_type</span><span class="special">&gt;</span> <span class="identifier">labels</span><span class="special">;</span>
	<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">load_image_dataset</span><span class="special">(</span><span class="identifier">images</span><span class="special">,</span> <span class="identifier">labels</span><span class="special">,</span> <span class="string">"/st/sync/files/ml-data/orl_faces/orl_faces_converted_png/s3.xml"</span><span class="special">);</span>

	<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">mmod_options</span> <span class="identifier">options</span><span class="special">{</span><span class="identifier">labels</span><span class="special">,</span> <span class="number">60</span><span class="special">,</span> <span class="number">50</span><span class="special">};</span>
	<span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">crap_net_type</span> <span class="identifier">net</span><span class="special">{</span><span class="identifier">options</span><span class="special">};</span>
	<span class="identifier">dlib</span><span class="special">::</span><span class="identifier">dnn_trainer</span><span class="special">&lt;</span><span class="identifier">my_dnn</span><span class="special">::</span><span class="identifier">crap_net_type</span><span class="special">&gt;</span> <span class="identifier">trainer</span><span class="special">{</span><span class="identifier">net</span><span class="special">};</span>
	
	<span class="identifier">trainer</span><span class="special">.</span><span class="identifier">set_synchronization_file</span><span class="special">(</span><span class="string">"./training_data.dat"</span><span class="special">);</span>

	<span class="identifier">trainer</span><span class="special">.</span><span class="identifier">train</span><span class="special">(</span><span class="identifier">images</span><span class="special">,</span> <span class="identifier">labels</span><span class="special">);</span>

	<span class="identifier">trainer</span><span class="special">.</span><span class="identifier">get_net</span><span class="special">();</span>

	<span class="identifier">utx</span><span class="special">::</span><span class="identifier">print</span><span class="special">(</span><span class="string">"trained net=&gt;\n"</span><span class="special">,</span> <span class="identifier">net</span><span class="special">);</span>
<span class="special">}</span>
</pre>
<h3>
<a name="cpp_dlib_dnn_cnn.h15"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.build_with_b2_build"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.build_with_b2_build">build
      with b2 build</a>
    </h3>
<p>
      jamfile (<span class="underline">jamroot</span>)
    </p>
<pre class="programlisting"><span class="identifier">lib</span> <span class="identifier">dlib</span>
	<span class="special">:</span>
	<span class="special">:</span>
		<span class="special">&lt;</span><span class="identifier">name</span><span class="special">&gt;</span><span class="identifier">dlib</span>
<span class="special">;</span>

<span class="identifier">exe</span> <span class="identifier">dnn</span>
	<span class="special">:</span>
		<span class="identifier">dnn</span><span class="special">.</span><span class="identifier">cpp</span>
	<span class="special">:</span>
		<span class="special">&lt;</span><span class="identifier">cxxstd</span><span class="special">&gt;</span><span class="number">23</span>
		<span class="special">&lt;</span><span class="identifier">library</span><span class="special">&gt;</span><span class="identifier">dlib</span>
		<span class="special">&lt;</span><span class="identifier">linkflags</span><span class="special">&gt;</span><span class="string">"-lpng -ljpeg"</span>
<span class="special">;</span>
</pre>
<h2>
<a name="cpp_dlib_dnn_cnn.h16"></a>
      <span class="phrase"><a name="cpp_dlib_dnn_cnn.role_cyan_see_also"></a></span><a class="link" href="cpp_dlib_dnn_cnn.html#cpp_dlib_dnn_cnn.role_cyan_see_also"><span class="cyan">See Also</span></a>
    </h2>
<p>
      <a href="http://dlib.net" target="_top">c++ dlib</a>
    </p>
<p>
      <a href="https://cppfx.xyz/utxcpp/utx_same_assert.html" target="_top">utx::same_assert</a>
    </p>
<p>
      <a href="https://cppfx.xyz/utxcpp/utx_print.html" target="_top">utx::print</a>
    </p>
<p>
      <a href="https://www.bfgroup.xyz/b2" target="_top">B2 Build</a>
    </p>
</div>
<div class="copyright-footer"></div>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="index.html"><img src="images/prev.png" alt="Prev"></a><a accesskey="u" href="index.html"><img src="images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="images/home.png" alt="Home"></a><a accesskey="n" href="cpp_boost_serialization.html"><img src="images/next.png" alt="Next"></a>
</div>
</body>
</html>
